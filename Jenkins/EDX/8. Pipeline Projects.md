# 8. Pipeline Projects

# Chapter Overview

In this chapter, we will go over Pipeline projects and explain how you can use them to create CI/CD workflows.

---

# Learning Objectives

By the end of this chapter, you should be able to:

* Explain what a Pipeline project is.
* Configure a Pipeline workflow.

---

# Freestyle vs Pipeline Projects

You should have noticed by now that Jenkins is mostly UI-centric, meaning all the projects are manually configured through the UI. If you recall from Chapter 1, Continuous Delivery heavily relies on seamless end-to-end automation. Although Freestyle projects provide you with a lot of flexibility to configure projects, they are not quite suitable to orchestrate complex CD scenarios. For example, if you want to build and test on a variety of OS platforms in parallel, or when you are waiting for some manual approval prior to deployment, etc.

Although you can create project hierarchies with Freestyle projects for representing multi-stage workflows, such strategy requires you to spread project configuration across multiple projects. Thus making it difficult to manage and maintain them as a simple change in one project might adversely affect the others. But that's not all, you might find it challenging to visualize a workflow spanning multiple Freestyle projects.

This is where Jenkins Pipelines come to your rescue by helping you:

* Create a set of instructions written as a code to model complex workflows.
* Provide a single-place visualization of different stages of your workflow.
* Keep all the Pipeline code stored in SCM, so you can apply SCM best practices such as versioning, tracking and auditing to the project configuration itself.

---

# Pipelines

Pipeline is a new Jenkins project type and a new way to model and visualize CI/CD workflow for a project. It is created by writing a bunch of instructions in a file called **Jenkinsfile**. The Jenkins Pipeline uses a domain-specific language based on [Apache Groovy](https://groovy-lang.org/) to create, edit, view, and run CD pipelines.

A Jenkinsfile can use either of the following two syntaxes:

* Declarative Pipelines: They require the [Blue Ocean](https://plugins.jenkins.io/blueocean/) plugin to be installed. You can easily create your Jenkinsfile using the Blue Ocean graphical pipeline editor. It also provides you with a great visualization of your pipeline runs.
* Scripted Pipelines: With scripted pipelines, you have the option of creating the Jenkinsfile using the classic Jenkins UI. This means you will be creating the Jenkins project using the Pipeline project type. While scripted pipelines offer a lot of flexibility, they also require you to have a knowledge of **Apache Groovy**.

It is worth noting that there is a lot of commonality in the syntactical components between declarative and scripted pipelines.

It is best to start out with declarative pipelines, and as you get comfortable with them, you can move on to scripted pipelines. For the remainder of this chapter, we will focus on declarative pipelines.

---

# Pipelines Terminology

Prior to creating Pipelines, you need to know a few basic pipeline-related terms. Let's take a look at them:

* Controller: A machine where Jenkins is installed. It centrally stores all the configurations, loads plugins and renders the Jenkins UI.
* Agent: A machine which connects to the Jenkins Controller and performs various operations as directed by the Jenkins Controller.
* Node: A machine that can allocate an executor and run Jenkins Pipelines. Examples are Jenkins Controllers and Agents.
* Step: A single task that tells Jenkins what to do at a given point in time. Examples include: executing a simple shell script and windows batch script.
* Stage: It is composed of logically distinct steps. Build, Test, Deploy are all examples of Stages. Stages are used for visualization of the Pipeline status/progress.

For a complete list of pipeline-related terms, see Jenkins' [Pipeline Glossary](https://www.jenkins.io/doc/book/glossary/).

---

# Creating a Pipeline

We will now talk about creating pipelines using the Blue Ocean graphical editor. Let's start by creating a Pipeline to simulate a CI/CD workflow with the following set of stages:

* Build: In this stage, source code is compiled and built, and an artifact is generated.
* Test: In this stage, tests will be run in parallel on two different OS platforms, Linux and Windows.
* Deploy Staging: In this stage, the artifacts will be deployed to a staging environment (essentially a pre-production server). If everything is good, we will request for approval to deploy to production.
* Deploy Production: In this stage, artifacts will be deployed to the production environment.

![image](https://user-images.githubusercontent.com/107522496/215825567-23297c70-fa42-4368-a9cd-62c4f77826dc.png)

We will also configure two post-build actions:

* Archive build artifacts
* Email notification in case of a build failure

Let's get started with creating the Pipeline.

--- 

# Creating a Pipeline: Open the Blue Ocean Editor






















































